#### ch14-main: 卡方分布-1.检验拟合优度；2.检验两个变量的独立性。

如果事实和期望不符呢？是正常波动还是概率模型本身有问题？利用卡方分布来分析。最近赌场突然变得赔钱了：老虎机、轮盘、骰子、二十一点，都出现了“太多”赢家，老板怀疑...

一、老虎机。每局两元，给出了设定的概率分布P569
```
x     -2     23     48     73     98
概率     0.977     0.008     0.008     0.006     0.001
```
和频数统计结果P569（总观察频数为1000）
```
x     -2     23     48     73     98
频数     965     10     9     9     7
```
列表对比P570，观察值与期望值之间存在差异。
```
x    观察值    期望值
-2    965    977
23    10    8
48    9    8
73    9    6
98    7    1
```
可以用χ2分布来检验观察值与期望值之间的差异是否“正常”。先确定（计算）检验统计量```χ2=∑(O-E)^2/E=38.27，其中O是观察值，E是期望值```，从算式来看χ2越大，期望值与观察值差异越大。

χ2大到什么程度才可以判定老虎机出了问题，而非偶然？卡方分布有一个参数ν（自由度数目），因此可以记```Χ2~χ2(ν)```，概率密度曲线受ν影响P573

老虎机问题中，ν=5-1=4，因为涉及5个期望频数，有1个“总频数和为1000”限制条件（有没有更好的理解方法。。。）接下来做显著性检验，用χ2分布进行的永远是单尾（右尾）检验，否定域是右尾，如果统计检验量在右尾否定域中，有理由否定原假设。（H0: 每局收益符合预设的概率分布，H1: 不符合）

χ2分布也是有概率表P575的，根据自由度ν 和显著性水平α 确定临界值，比如老虎机（4,0.05）查表确定临界值为9.49

（右尾检验）所以拒绝域是χ2＞9.49，而前面计算得出值是38.27，已经落在拒绝域，有充分证据reject[原假设H0: 观察值仍符合概率分布]. 于是赌场关停了这些老虎机。__以上就是拟合优度检验，有一组数据，希望它符合某种分布，拟合优度检验就是看看这组数据是否确实符合这种分布__。

二、骰子：用1%显著性水平检验，观察值已给出P582，自己填期望值。H0: 公正，H1: 不公正
```
x    O    E
1    107    167
2    198    167
3    192    167
4    125    167
5    132    167
6    248    167
```
按公式算χ2=88.24，根据(ν,α)=(5,0.01)查表确定临界值为15.09。决策：在1%显著性水平下，有充分证据reject原假设H0

χ2分布可以检验任何概率分布的拟合优度，唯一困难在于自由度的计算，好在已经总结好了P584直接用即可

三、二十一点。老板觉得有一桌上庄家赔钱的概率高于合理值，请判断下这种怀疑有没有道理——需要某种方法，检验庄家的选择与赌局的输赢有无影响——用χ2分布检验两种因素是否互相独立。下面是负责二十一点的三个庄家的表现P585

为了计算检验统计量χ2，需要知道期望值（which并没有），只能依靠概率计算。首先画出列联表P587（下图中仅白底部分），
然后按照表中数据计算，如```P(A坐庄)=98/250, P(赌局胜)=114/250```，如果二者互相独立，那么相乘即应是```P(A坐庄时赌局胜)=P(A坐庄)*P(赌局胜)=98/250*114/250，E(A庄赢局)=250*98/250*114/250=44.688```. 这时可以做出归纳出期望频数的通用算式：```E=sum_r(胜)*sum_c(A)/total```，进而算出所有的E，然后求得 χ2=5.62

H0:赌局胜负与庄家无关，H1:有关。【__大问题__：为什么H0是无关而H1是有关？能不能反过来？要翻前面拒绝域范围定义？(__当前猜测：H0是按常理为true的__) 】
自由度ν=4（反正公式是```(r-1)*(c-1)，其中r是列联表行数，c是列数```，先记住，暂无好的理解方法），选用1%的显著性水平。按(ν,α)=(4,0.01)查表得```χ2(1%,4)=13.28```，即否定域由χ2>13.28给出，所以上面算出的5.62位于否定域之外，接受原假设：没有足够的证据表明赌局结果和庄家有关。
